<script type="module" src="{{ base_path }}/assets/js/main.min.js"></script>

{% include analytics.html %}

{%- if jekyll.environment == 'production' and site.analytics.provider and site.analytics.provider != 'false' -%}
  {%- include /analytics-providers/{{ site.analytics.provider }}.html -%}
{%- endif -%}

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const targets = document.querySelectorAll(".archive__item, .publication-item, .page-content h2, .page-content p, .page-content ul, .page-content ol");

    const observer = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
          observer.unobserve(entry.target);
        }
      });
    }, {
      threshold: 0.1
    });

    let delay = 0;
    targets.forEach(target => {
      // Apply a cascading delay, but only if it's not explicitly set
      if (!target.style.animationDelay) {
        target.style.animationDelay = `${delay}ms`;
        delay += 50;
      }
      observer.observe(target);
    });
  });
</script>

<!-- Vanta.js for animated hero -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.globe.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  if (document.getElementById('vanta-hero')) {
    VANTA.GLOBE({
      el: "#vanta-hero",
      mouseControls: true,
      touchControls: true,
      gyroControls: false,
      minHeight: 500.00,
      minWidth: 200.00,
      scale: 1.00,
      scaleMobile: 0.80,
      color: 0x64b5f6, // Softer blue
      color2: 0x42a5f5, // Complementary blue
      backgroundColor: 0x1e3c72, // Matches gradient start
      size: 1.20,
      speed: 0.6
    });
  }
});
</script>
